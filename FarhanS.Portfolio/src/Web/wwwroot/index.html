<!--
  NOTE: This file is overwritten by index.github.html during GitHub Pages deployment.
  For local development, use this file. For GitHub Pages, index.github.html is copied as index.html with the correct <base href>.
-->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Farhan S. - Software Developer Portfolio showcasing skills, projects and professional experience" />
    <title>Farhan S. - Portfolio</title>
    <base href="/" />
      <!-- Content Security Policy -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; 
        script-src 'self' 'unsafe-inline' 'unsafe-eval' https://cdn.jsdelivr.net; 
        style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdn.jsdelivr.net; 
        img-src 'self' https://logos-world.net https://upload.wikimedia.org data:; 
        font-src 'self' https://fonts.gstatic.com https://cdn.jsdelivr.net; 
        connect-src 'self' https://cdn.jsdelivr.net https://fonts.googleapis.com; 
        worker-src 'self' blob:;" />    <!-- Favicon -->
    <link rel="icon" type="image/png" href="favicon.png?v=1748620273" />
    <link rel="icon" type="image/png" sizes="192x192" href="favicon.png?v=1748620273">
    <link rel="icon" type="image/png" sizes="512x512" href="favicon.png?v=1748620273">
    <link rel="apple-touch-icon" sizes="512x512" href="favicon.png?v=1748620273">
    
    <!-- Add preloading for critical resources -->
    <link rel="preload" href="_framework/blazor.webassembly.js" as="script" />
    <link rel="preload" href="css/theme.css" as="style" />
    <link rel="preload" href="css/layout.css" as="style" />
    <link rel="preload" href="css/app.css" as="style" />    <link rel="preload" href="js/theme.js" as="script" />
    <link rel="preload" href="js/navigation.js" as="script" />
      <!-- Preconnect to external resources -->
    <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin />
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="preconnect" href="https://logos-world.net" crossorigin />
    <link rel="preconnect" href="https://upload.wikimedia.org" crossorigin />
    
    <!-- Standard stylesheets with priority loading order for proper cascading -->
    <link rel="stylesheet" href="lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="css/theme.css" /> <!-- Theme variables first -->
    <link rel="stylesheet" href="css/layout.css" /> <!-- Layout styles second -->
    <link rel="stylesheet" href="css/app.css" /> <!-- Application styles last -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" media="print" onload="this.media='all'" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" media="print" onload="this.media='all'" />    
    <!-- Application Insights removed for GitHub Pages deployment -->
    
      <!-- Theme JavaScript - loaded early for fast theme switching -->
    <script src="js/theme.js"></script>
    
    <!-- Initialize JavaScript managers immediately to prevent timing issues -->
    <script>
        // Ensure themeManager and navigationManager are available immediately
        window.themeManager = window.themeManager || {
            isDarkMode: function() {
                return document.documentElement.getAttribute('data-theme') === 'dark';
            },
            toggle: function() {
                console.log('Theme manager not fully loaded yet');
            },
            getTheme: function() {
                return document.documentElement.getAttribute('data-theme') || 'dark';
            }
        };
        
        window.navigationManager = window.navigationManager || {
            initializeSmoothScroll: function() {
                console.log('Navigation manager not fully loaded yet');
            },
            registerIntersectionObservers: function() {
                console.log('Navigation manager not fully loaded yet');
            },
            setupNavbarAnimation: function() {
                console.log('Navigation manager not fully loaded yet');
            }
        };
        
        window.scrollToSection = window.scrollToSection || function(sectionId) {
            console.log('Scroll function not fully loaded yet');        };
    </script>
</head>

<body>
    <div id="app">
        <!-- Improved loading spinner -->
        <div class="loading-container">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <p class="mt-2">Loading awesome content...</p>
        </div>
    </div>

    <div id="blazor-error-ui" style="display: none;">
        An unhandled error has occurred.
        <a href="." class="reload">Reload</a>
        <span class="dismiss">ðŸ—™</span>
    </div>
    
    <!-- Add defer to improve page load performance -->
    <script src="_framework/blazor.webassembly.js" defer></script>
    
    <!-- Bootstrap JS -->
    <script src="lib/bootstrap/dist/js/bootstrap.bundle.min.js" defer></script>
      <!-- Navigation script - loaded after main app -->
    <script src="js/navigation.js" defer></script>
      <!-- Simple service worker registration for GitHub Pages -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('/service-worker-simple.js')
                    .then(function(registration) {
                        console.log('Simple Service Worker registered');
                    })
                    .catch(function(error) {
                        console.log('Service Worker registration failed:', error);
                    });
            });
        }
    </script>
  
    
    <script>
        // Handle Blazor errors gracefully
        window.addEventListener('unhandledrejection', function(event) {
            console.log('Unhandled Promise Rejection:', event.reason);
            // Prevent the error UI from showing in some cases
            if (event.reason && event.reason.message && 
                event.reason.message.includes('subscriber to the content with the given section ID')) {
                event.preventDefault();
                event.stopPropagation();
            }
        });
        
        // Initialize error handling on page load
        window.addEventListener('load', function() {
            // Hide the Blazor error UI if it appears due to known issues
            const errorUI = document.getElementById('blazor-error-ui');
            if (errorUI) {
                const observer = new MutationObserver(function(mutations) {
                    mutations.forEach(function(mutation) {
                        if (mutation.attributeName === 'style' && 
                            errorUI.style.display === 'block') {
                            // If error UI is shown but app is still functioning, hide it
                            console.log('Handling Blazor error gracefully...');
                            setTimeout(() => {
                                if (document.querySelector('main') && document.querySelector('main').children.length > 0) {
                                    errorUI.style.display = 'none';
                                }
                            }, 3000);
                        }
                    });
                });
                
                observer.observe(errorUI, { attributes: true });            }
        });
    </script>
      <!-- Configuration loading script simplified for GitHub Pages -->
    <script>
        (async function () {
            try {
                // Simple configuration loading for static hosting
                let response = await fetch('appsettings.json');
                let settings = await response.json();
                
                // Log that we've loaded settings
                console.log('Application settings loaded for GitHub Pages');
            } catch (e) {
                console.log('No application settings found - using defaults for GitHub Pages');
            }
        })();
    </script>
</body>

</html>
